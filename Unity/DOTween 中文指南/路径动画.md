# 路径动画

```
public Transform target;
public PathType pathType = PathType.CatmullRom;  //曲线
public Vector3[] waypoints = new[] {
	new Vector3(4, 2, 6),
	new Vector3(8, 6, 14),
	new Vector3(4, 6, 14),
	new Vector3(0, 6, 6),
	new Vector3(-3, 0, 0)
};
void Start()
{
	Tween t = target.DOPath(waypoints, 4, pathType)
		.SetOptions(true)  //闭合路径
		.SetLookAt(0.001f);  //target朝向
	t.SetEase(Ease.Linear).SetLoops(-1);  //无限循环
}
```

操作路径控制点（Pro）：
```
path = GetComponent<DOTweenPath>();
path.wps.Clear();
path.fullWps.Clear();
Ray ray;
foreach (Vector3 point in points)
{
    Vector3 v = point;
    v.y = 5000;
    ray = new Ray(v, Vector3.down);
    if (Physics.Raycast(ray.origin, ray.direction, out hitInfo, 10000, terrainLayer.value))
    {
        path.wps.Add(hitInfo.point);
        transform.position = hitInfo.point;
    }
}
System.Type type = typeof(DOTweenPath);
path.path = null;
type.GetMethod("Reset", System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Instance).Invoke(path, null);
type.GetMethod("Awake", System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Instance).Invoke(path, null);
Tween t = path.GetTween();
t.ForceInit();
```

手动创建tween对象：
```
    Tween CreateTween()
    {
        //注意：不能执行删除操作！
        //if (dotweenPath.tween != null)
        //    dotweenPath.tween.Kill();
        //dotweenPath.tween = null;

        //判断是否自动播放
        if (start == ASMB.TweenInfo.StartEnum.auto)
            dotweenPath.autoPlay = true;

        //设置动画start顺序
        if (dotweenPath.onComplete == null)
            dotweenPath.onComplete = new UnityEngine.Events.UnityEvent();
        dotweenPath.hasOnComplete = true;
        dotweenPath.onComplete.RemoveListener(_OnComplete);
        dotweenPath.onComplete.AddListener(_OnComplete);

        if (onPlay == null)
            onPlay = new UnityEngine.Events.UnityEvent();
        hasOnPlay = true;
        onPlay.RemoveListener(_OnPlay);
        onPlay.AddListener(_OnPlay);

        //全部设置完成后开始创建tween
        System.Type type = typeof(DOTweenPath);
        dotweenPath.path = null;
        type.GetMethod("Reset", System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Instance).Invoke(dotweenPath, null);
        type.GetMethod("Awake", System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Instance).Invoke(dotweenPath, null);
        Tween t = dotweenPath.tween;
        if (t == null)
        {
            Debug.LogError("tween没有初始化成功！");
        }
        t.ForceInit();
        t.OnRewind(_OnRewind);
        return t;
    }
```