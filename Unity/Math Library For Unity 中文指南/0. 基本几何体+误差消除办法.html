<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>0. 基本几何体+误差消除办法 - </title>
  <style type="text/css">code{white-space: pre;}</style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style type="text/css">
  h1,h2,h3,h4,h5,h6,p,div,blockquote,ol,ul,li,img,li div{font-size:14px;font-family:"Hiragino Sans GB","Microsoft YaHei",tahoma,arial,simsun;line-height:21px;vertical-align:baseline;color:#0CF;word-wrap:break-word;word-break:normal;margin:0 0 20px;padding:0;}body{background-color:#1A1A1A;margin:10px;}embed,img{max-width:100%;margin:5px auto 0;}embed{margin:5px auto;}strong,em{color:#C0F;}ol,ul{margin:0 0 10px 2em;}ul ul,ol ol,ul ol,ol ul{margin:0 0 5px 2em;}li{margin-bottom:5px;}h1,h2,h3,h4,h5,h6{color:#FC0;border-color:#FC0;margin:20px 0 10px;}h1{margin-top:80px;font-size:28px;line-height:32px;border-bottom:2px solid;padding-bottom:0;}h2{font-size:24px;line-height:28px;}h3{font-size:22px;line-height:26px;}h4{font-size:20px;line-height:24px;}h5{font-size:18px;line-height:22px;}h6{font-size:16px;line-height:20px;}code{font-family:Menlo,Monaco,Consolas,"Andale Mono","lucida console","Courier New",monospace;font-size:12px;line-height:1.5;box-shadow:0 0 8px rgba(0,0,0,0.4);color:#C0F;background-color:#510065;border:1px solid #C0F;border-radius:3px;word-wrap:normal;padding:0 4px;}pre{display:inline-block;margin:0 0 10px;min-width: 100%;}pre>code{border:none!important;padding:5px 10px!important;}a,a:active,a:visited{font-weight:bold;color:#C0F;}a:hover{background-color:#510065;}hr{border-width:0;border-top:1px dashed #0CF;margin:20px 0;}blockquote{background-color:#005266;border-left:5px solid #0CF;border-radius:3px;padding:5px 10px;}blockquote p{margin:0;}
  </style>
  
  
  <meta charset="UTF-8"/>
  <meta name="author" content="潘霄鹏 - weibo.com/pxp1230">
  <meta name="keywords" content="潘霄鹏笔记">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
  tex2jax: {inlineMath:[['$','$']],processEscapes:true}
  });
  </script>
  <script type="text/javascript" src="file:///storage/emulated/0/MathJax-master/MathJax-master/MathJax.js?config=TeX-AMS_HTML"></script>
  <script type="text/javascript" src="file:///C:/MathJax-master/MathJax-master/MathJax.js?config=TeX-AMS_HTML"></script>
  <script type="text/javascript" src="file:///storage/emulated/0/highlight/highlight.pack.js"></script>
  <script type="text/javascript" src="file:///C:/highlight/highlight.pack.js"></script>
  <script type="text/javascript" src="file:///storage/emulated/0/pxp1230.github.io.js"></script>
  <script type="text/javascript" src="file:///C:/pxp1230.github.io.js"></script>
  <script type="text/javascript">
  if(window.location.protocol!="file:"){var d=document,s=d.createElement('script');s.src='/pxp1230.github.io.js';d.head.appendChild(s);}
  </script>
</head>
<body>
<h2>误差消除办法</h2>
<p>C#中的隐式类型转换（float→double、double→float）会带来难以察觉的误差：</p>
<pre><code>Debug.Log(v0.DotPerp(v1) - Vector3.Cross(v0, v1).z);//输出-1.861E-05，错误</code></pre>
<p>解决方案：使用强制类型转换</p>
<pre><code>Debug.Log((float)v0.DotPerp(v1) - Vector3.Cross(v0, v1).z);//输出0，正确</code></pre>
<h2>术语</h2>
<ul>
<li>Perpendicular：垂直，正交</li>
<li>Equidistant：等距</li>
<li>Parallel：平行</li>
<li>Evaluate/Evaluation：根据定义式求值</li>
<li>acute angle：锐角</li>
<li>obtuse angle：钝角</li>
<li>Circumscribed：外接的</li>
<li>Inscribed：内切的</li>
<li>Perimeter：周长</li>
<li>CW：Clock-Wise 顺时针方向</li>
<li>CCW：Counter Clock-Wise 逆时针方向</li>
<li>Polyhedron：多面体</li>
</ul>
<h2 id="d">2D</h2>
<ul>
<li>Line2：2D直线，内部由一点和<strong>方向（必须归一化）</strong>确定。可以用两点创建。在右侧的点或Box到直线的距离为正，在直线上的点或相交的Box的距离为0，在左侧的点或Box到直线的距离为负，AAB、圆同理。两条直线的夹角就是两个方向的夹角。</li>
<li>Ray2：2D射线，内部由一点和<strong>方向（必须归一化）</strong>确定。</li>
<li>Segment2：2D线段，内部由起点、终点、中点、方向、半长确定。</li>
<li>AAB2：2D Axis-Aligned Box，内部由左下角点、右上角点确定。可以用任意多点创建。可计算出重心、半宽高、四角顶点（从左下角开始逆时针方向）、面积。可用另一个点或AAB来扩张它。</li>
<li>Box2：2D Box，内部由重心、两个正交轴方向（必须归一化）、半宽、半高确定。AAB可转换成Box。可以用任意多点创建。可计算出四角顶点（从左下角开始逆时针方向）、面积。可用另一个Box来扩张它。</li>
<li>Circle2：2D圆，内部由圆点、半径确定。可以用AAB或任意多点创建。可以创建指定三角形的外接圆和内切圆。可计算出周长、面积。定义式中的t取值范围为[0,2*pi)。可用另一个Circle来扩张它。</li>
<li>Triangle2：2D三角形，内部由三个顶点确定，逆时针方向为正方向。可计算出三边（Edge[i] = V[i+1]-V[i]）、边01和边02的叉积和方向、面积、三个顶点的弧度、判断一点是否在三角形内（在外返回+1，在边上返回0，在内返回-1）（为了返回结果的一致性建议使用ContainsCCW、ContainsCW）</li>
<li>Polygon2：2D多边形（不自相交），内部由顶点集合确定。3D多边形可投影到xy平面、xz平面或yz平面转换成2D多边形。可计算出边集合（当顶点发生变化时需要手动刷新）、顶点数、重心、周长、面积、是否为凸多边形、顺时针环绕还是逆时针环绕、是否存在角度为0的角、更改环绕方向、判断一点是否在多边形内（在外返回+1，在边上返回0，在内返回-1）（支持凹多边形）</li>
</ul>
<h2 id="d-1">3D</h2>
<ul>
<li>Line3：3D直线，内部由一点和方向（必须归一化）确定。可以用两点创建。可计算出点到直线的距离。两条直线的夹角就是两个方向的夹角。</li>
<li>Ray3：3D射线，内部由一点和方向（必须归一化）确定。</li>
<li>Segment3：3D线段，内部由起点、终点、中点、方向、半长确定。</li>
<li>Plane3：3D平面，内部由平面法向量（必须归一化）、平面常数（=Dot(法向量, 平面上一点)）确定。可以用法向量和平面上一点创建。也可以用平面上任意三点创建，遵从左手螺旋定则。可计算出原点到平面的垂足、平面法线与一条直线方向的夹角、平面与一条直线方向的夹角、两平面的夹角。法线方向的一面为正面。可以判断一个点、Box3、AAB3、球是否在正面、反面或相交。</li>
<li>Rectangle3：2D Box转3D，内部由重心、两个正交轴方向（必须归一化）、半宽、半高确定。可以用四个点创建。可计算出四角顶点（从左下角开始逆时针方向）、面积、平面法向量（=Cross(Axis0, Axis1)）。</li>
<li>AAB3：3D Axis-Aligned Box，内部由最小点、最大点确定。可以用任意多点创建。可计算出重心、半宽高、八角顶点（从左下角开始逆时针方向，z从小到大）、体积。可用另一个点或AAB来扩张它。</li>
<li>Box3：3D Box，内部由重心、三个正交轴方向（必须归一化）、半宽、半高、半深确定。AAB可转换成Box。可以用任意多点创建。可计算出八角顶点（从左下角开始逆时针方向，z从小到大）、体积。可用另一个Box来扩张它。</li>
<li>Circle2：2D圆转3D，内部由圆点、半径、两个正交轴方向（必须归一化）确定。可以用圆点、半径、平面法向量（必须归一化）创建。可以创建指定三角形的外接圆和内切圆。可计算出周长、面积、平面法向量（=Cross(Axis0, Axis1)）。定义式中的t取值范围为[0,2*pi)。</li>
<li>Sphere3：球，内部由圆点、半径确定。可以用AAB或任意多点创建。可以创建指定四面体的外接球和内切球。可计算出表面积、体积。可用另一个球来扩张它。</li>
<li>Triangle3：3D三角形，内部由三个顶点确定。可计算出三边（Edge[i] = V[i+1]-V[i]）、边01和边02的叉积和方向、面积、三个顶点的弧度。</li>
<li>Polygon3：2D多边形（不自相交）转3D，内部由顶点集合（需要手动投影到平面）、所在平面确定。3D多边形可投影到任一平面转换成2D多边形。可计算出边集合（当顶点发生变化时需要手动刷新）、顶点数、重心、周长、是否存在角度为0的角、更改环绕方向。</li>
<li>Capsule3：胶囊体，内部由线段、半径确定。</li>
</ul>
</body>
</html>
