<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>9. 伪随机数生成器+随机采样器 - </title>
  <style type="text/css">code{white-space: pre;}</style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style type="text/css">body{font:14px/200%"Hiragino Sans GB","Microsoft YaHei",tahoma,arial,simsun;color:#00CCFF;background:#1A1A1A;word-wrap:break-word;word-break:normal}img{max-width:100%}html,body,h1,h2,h3,h4,h5,h6,p,blockquote,ol,ul,li,img,li div{margin:0;padding:0;font:14px/200%"Hiragino Sans GB","Microsoft YaHei",tahoma,arial,simsun;line-height:22px;vertical-align:baseline;color:#00CCFF}body{margin:10px}p,div{margin-bottom:20px}strong{font-weight:bold}ol,ul{margin-left:2em;margin-bottom:20px}ul ul,ol ol,ul ol,ol ul{margin-top:10px}li{margin-bottom:10px}h1,h2,h3,h4,h5,h6{font-weight:lighter;text-transform:capitalize;margin-top:20px;margin-bottom:20px}h1{font-size:24.624px;line-height:29.548799999999996px}h2{font-size:24.624px;line-height:29.548799999999996px}h3{font-size:23.44px;line-height:28.128px}h4{font-size:22.16px;line-height:26.592px}h5{font-size:22.16px;line-height:26.592px}h6{font-size:22.16px;line-height:26.592px}img{margin-bottom:20px}h1 img,h2 img,h3 img,h4 img,h5 img,h6 img,p img{margin-bottom:0}pre{color:#00CCFF;margin-bottom:20px;white-space:pre;white-space:pre-wrap;word-wrap:break-word}code{font-family:Menlo,Monaco,Consolas,"Andale Mono","lucida console","Courier New",monospace;font-size:12px;line-height:1.5;box-shadow:0 0 8px rgba(0,0,0,0.4);padding:2px 4px;color:#FC0;background-color:#232400;border:1px solid#333500;border-radius:3px}pre>code{padding:1em!important;border:none!important}h1{text-transform:uppercase;font-weight:bold;border-bottom:1px solid;padding-bottom:4px}h2{border-bottom:1px solid;padding-bottom:4px}h3,h4,h5,h6{border-bottom:none}html body{background-color:#1A1A1A}html h1,html h2,html h3,html h4,html h5,html h6{color:#FFCC00;border-color:#FFCC00}html a,html a:active,html a:visited{color:#FFCC00}html a:hover{background-color:#554400}html a,html a:active,html a:visited,html code.url{color:#FFCC00}html h2,html h3,html h4,html h5,html h6{color:#FFCC00}hr{border:0;background-color:#CC0000;height:4px;margin:40px auto}blockquote{background:#073642;border-left:10px solid#005266;margin:1.5em 10px;padding:.5em 10px}blockquote code{color:#00CCFF;font-family:"Hiragino Sans GB","Microsoft YaHei",tahoma,arial,simsun}blockquote pre{margin:0;padding:0}blockquote p,blockquote div{margin-bottom:0}strong{color:#FFCC00}</style>
  
  
  <meta charset="UTF-8"/>
  <meta name="author" content="潘霄鹏 - weibo.com/pxp1230">
  <meta name="keywords" content="潘霄鹏笔记">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
  tex2jax: {inlineMath:[['$','$']],processEscapes:true}
  });
  </script>
  <script type="text/javascript"
  src="file:///storage/emulated/0/MathJax-master/MathJax-master/MathJax.js?config=TeX-AMS_HTML">
  </script>
  <script type="text/javascript"
  src="file:///C:/MathJax-master/MathJax-master/MathJax.js?config=TeX-AMS_HTML">
  </script>
  <link rel="stylesheet" href="file:///storage/emulated/0/highlight/styles/pojoaque.css">
  <script type="text/javascript"
  src="file:///storage/emulated/0/highlight/highlight.pack.js">
  </script>
  <link rel="stylesheet" href="file:///C:/highlight/styles/pojoaque.css">
  <script type="text/javascript"
  src="file:///C:/highlight/highlight.pack.js">
  </script>
  <script type="text/javascript">
  document.onkeydown=function(e){if(typeof(disableListenKeyDownEvent)=='undefined'){if(e.keyCode==88||e.keyCode==46){window.open('','_self');window.close()}else if(e.keyCode==8)window.open('index.html','_self')}}
  if(window.location.protocol!="file:"){var d=document,s=d.createElement('script');s.src='/pxp1230.github.io.js';(d.head||d.body).appendChild(s);}else{hljs.initHighlightingOnLoad();}
  </script>
</head>
<body>
<h2 id="---rand">伪随机数生成器 - Rand类</h2>
<p><strong>● 伪随机数生成器，英文名Pseudo Random Number Generators (PRNG)，采用著名的Xorshift128随机数生成算法。</strong></p>
<p>static Rand Instance<br />
使用默认种子<br />
Rand()<br />
使用随机种子<br />
Rand(int seed)<br />
使用自定义种子<br />
void ResetSeed(int seed)<br />
重新指定种子</p>
<p>void GetState(out uint x, out uint y, out uint z, out uint w)<br />
获取生成器内部状态，可用于生成器的序列化<br />
void SetState(uint x, uint y, uint z, uint w)<br />
设置生成器内部状态，可用于生成器的反序列化</p>
<p>Quaternion RandomRotation()<br />
随机生成四元数</p>
<p>int NextInt()<br />
随机生成整数，范围 [int.MinValue,int.MaxValue].<br />
int NextInt(int max)<br />
随机生成整数，范围 [0,max)<br />
int NextInt(int min, int max)<br />
随机生成整数，范围 [min,max). max must be &gt;= min.<br />
int NextIntInclusive(int min, int max)<br />
随机生成整数，范围 [min,max]. max must be &gt;= min.<br />
int NextPositiveInt()<br />
随机生成整数，范围 [0,int.MaxValue].<br />
uint NextUInt()<br />
随机生成无符号整数，范围 [0,uint.MaxValue].</p>
<p>double NextDouble()<br />
随机生成双精度浮点数，范围 [0,1).<br />
double NextDouble(double min, double max)<br />
随机生成双精度浮点数，范围 [min,max).<br />
float NextFloat()<br />
随机生成单精度浮点数，范围 [0,1).<br />
float NextFloat(float min, float max)<br />
随机生成单精度浮点数，范围 [min,max).</p>
<p>bool NextBool()<br />
随机生成布尔值.</p>
<p>byte NextByte()<br />
随机生成byte值.</p>
<p>Color RandomColorOpaque()<br />
Color32 RandomColor32Opaque()<br />
随机生成不透明颜色.<br />
Color RandomColorTransparent()<br />
Color32 RandomColor32Transparent()<br />
随机生成透明颜色.</p>
<p>float RandomAngleRadians()<br />
随机生成弧度值，范围 [0,2*pi)<br />
float RandomAngleDegrees()<br />
随机生成角度值，范围 [0,360)</p>
<p>Vector2 InSquare(float side = 1f)<br />
随机生成指定大小的正方形区域内的点<br />
Vector2 OnSquare(float side = 1f)<br />
随机生成指定大小的正方形边界上的点<br />
Vector3 InCube(float side = 1f)<br />
随机生成指定大小的立方体区域内的点<br />
Vector3 OnCube(float side = 1f);<br />
Vector2 InCircle(float radius = 1f);<br />
Vector2 InCircle(float radiusMin, float radiusMax);<br />
Vector2 OnCircle(float radius = 1f);<br />
Vector3 InSphere(float radius = 1f);<br />
Vector3 OnSphere(float radius = 1f);<br />
Vector3 InTriangle(ref Vector3 v0, ref Vector3 v1, ref Vector3 v2);<br />
Vector3 InTriangle(Vector3 v0, Vector3 v1, Vector3 v2);</p>
<h2 id="---weightedsampler">加权随机采样器 - WeightedSampler类</h2>
<p>WeightedSampler(float[] weights)<br />
权重不需要归一化，采用 Rand.Instance 生成器.<br />
WeightedSampler(float[] weights, Rand rand)<br />
权重不需要归一化，采用自定义随机数生成器.<br />
int SampleIndex()<br />
根据权重返回随机的weights数组下标</p>
<h2 id="---indexedtrianglessamplernonindexedtrianglessampler">网格表面随机采样器 - IndexedTrianglesSampler类、NonIndexedTrianglesSampler类</h2>
<ul>
<li><p>IndexedTrianglesSampler类：<br />
IndexedTrianglesSampler(Vector3[] vertices, int[] indices)<br />
使用网格数据创建采样器，采用 Rand.Instance 生成器.<br />
IndexedTrianglesSampler(Vector3[] vertices, int[] indices, Rand rand)<br />
使用网格数据创建采样器，采用自定义随机数生成器.<br />
IndexedTrianglesSampler(Mesh mesh)<br />
使用网格（mesh.vertices and mesh.GetIndices(0)）创建采样器，采用 Rand.Instance 生成器.<br />
IndexedTrianglesSampler(Mesh mesh, Rand rand)<br />
使用网格（mesh.vertices and mesh.GetIndices(0)）创建采样器，采用自定义随机数生成器.<br />
Vector3 Sample()<br />
Vector3[] SampleArray(int count)<br />
Vector3[] SampleArray(int count, Vector2[] uvs, Texture2D sampleMap, float min = 0f, float max = 1f)<br />
结合纹理（R通道作为权重）进行采样，It's also possible to explicitly set additional range of chances (so that if sample map has gradient from 0 to 1, then adding min to 0.5 will result in no samples generated in areas with color &lt;= 0.5). 注意，在该函数中参数count是作为采样上限（一些采样点会被sampleMap过滤）</p></li>
<li><p>NonIndexedTrianglesSampler类：<br />
NonIndexedTrianglesSampler(Vector3[] vertices)<br />
使用网格数据创建采样器，采用 Rand.Instance 生成器.<br />
NonIndexedTrianglesSampler(Vector3[] vertices, Rand rand)<br />
使用网格数据创建采样器，采用自定义随机数生成器.<br />
NonIndexedTrianglesSampler(Mesh mesh)<br />
使用网格（mesh.vertices）创建采样器，采用 Rand.Instance 生成器.<br />
NonIndexedTrianglesSampler(Mesh mesh, Rand rand)<br />
使用网格（mesh.vertices）创建采样器，采用自定义随机数生成器.<br />
Vector3 Sample()<br />
Vector3[] SampleArray(int count)</p></li>
</ul>
<h2 id="2d---poissondisksampler">泊松圆盘采样器（采样点2D均匀分布） - PoissonDiskSampler类</h2>
<p><strong>● 仅支持矩形区域</strong></p>
<p>PoissonDiskSampler(Rand rand, Vector2 minCorner, Vector2 maxCorner, float minDistanceOuter, float minDistanceInner = 1f)<br />
参数minDistanceOuter：采样点最小间距<br />
参数minDistanceInner：当指定DistanceFilter委托时才会使用该参数，DistanceFilter委托返回值范围 [0...1]，转换成采样点间距（[0...1] → [minDistanceInner...minDistanceOuter]）</p>
<p>PointDelegate DistanceFilter<br />
委托：float DistanceFactor(ref Vector2 point)</p>
<p>int MaxPoints { get; set; }<br />
设置采样点数量上限</p>
<p>List<Vector2> Sample()</p>
<h2 id="3d---pointsfilter">顶点集过滤（采样点3D均匀分布，暴力法） - PointsFilter类</h2>
<p>static List<int> DistanceFilter(Vector3[] points, AAB3 pointsAAB, float radius, Rand rand)<br />
将满足条件的顶点过滤出来<br />
参数radius：采样点最小间距<br />
示例：</p>
<pre><code>List&lt;int&gt; indices = PointsFilter.DistanceFilter(points, MeshFilter.sharedMesh.bounds, Distance, Rand.Instance);
Vector3[] filteredPoints = new Vector3[indices.Count];
for (int i = 0; i &lt; indices.Count; ++i)
{
    filteredPoints[i] = points[indices[i]];
}</code></pre>
<h2 id="---shufflebag">洗牌袋 - ShuffleBag<T>类</h2>
<p>int Count { get; }<br />
返回包容量<br />
ShuffleBag()<br />
包容量（capacity）为0<br />
ShuffleBag(int capacity)<br />
ShuffleBag(Rand rand)<br />
ShuffleBag(Rand rand, int capacity)<br />
void Add(T item, uint count = 1)<br />
添加元素（指定该元素的数量）<br />
T NextItem()<br />
取元素<br />
void Reset()<br />
重新打乱顺序<br />
void Clear()<br />
IEnumerator<T> GetEnumerator()</p>
<h2 id="---util">洗牌 - Util类</h2>
<p>static void Shuffle<T>(this IList<T> collection)<br />
static void Shuffle<T>(this T[] collection)<br />
static void Shuffle<T>(this IList<T> collection, Rand rand)<br />
static void Shuffle<T>(this T[] collection, Rand rand)</p>
</body>
</html>
